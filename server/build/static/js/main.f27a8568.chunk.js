(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{112:function(e,t){},133:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(24),c=a.n(r),l=(a(75),a(14)),o=a(28),u=a(15),i=a(68),m=a(8),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoading:!0,errMess:null,messages:null,selecteduser:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOADING_MESSAGES":return Object(m.a)({},e,{isLoading:!0,errMess:null,messages:null,selecteduser:null});case"MESSAGES_FAILED":return Object(m.a)({},e,{isLoading:!1,errMess:t.payload,messages:null,selecteduser:null});case"ADD_MESSAGES":return Object(m.a)({},e,{isLoading:!1,errMess:null,messages:t.payload,selecteduser:null});case"ADD_MESSAGE":return{state:e,isLoading:!1,errMess:null,messages:0===e.messages.filter((function(e){return e._id===t.payload._id})).length?e.messages.concat(t.payload):e.messages,selecteduser:e.selecteduser};case"SELECTED":return Object(m.a)({},e,{selecteduser:t.payload});default:return e}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoading:!0,errMess:null,users:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOADING_USERS":return Object(m.a)({},e,{isLoading:!0,errMess:null,users:null});case"USERS_FAILED":return Object(m.a)({},e,{isLoading:!1,errMess:t.payload,users:null});case"ADD_USERS":return Object(m.a)({},e,{isLoading:!1,errMess:null,users:t.payload});default:return e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoading:!1,isAuthenticated:!!localStorage.getItem("token"),token:localStorage.getItem("token"),user:localStorage.getItem("userdetails")?JSON.parse(localStorage.getItem("userdetails")):null,errMess:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_REQUEST":return Object(m.a)({},e,{isLoading:!0,isAuthenticated:!1,user:t.creds});case"LOGIN_SUCCESS":return Object(m.a)({},e,{isLoading:!1,isAuthenticated:!0,errMess:"",token:t.token,user:t.user});case"LOGIN_FAILURE":return Object(m.a)({},e,{isLoading:!1,isAuthenticated:!1,errMess:t.error});case"LOGOUT_REQUEST":return Object(m.a)({},e,{isLoading:!0,isAuthenticated:!0});case"LOGOUT_SUCCESS":return Object(m.a)({},e,{isLoading:!1,isAuthenticated:!1,token:"",user:null});default:return e}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoading:!1,errMess:null,user:null,success:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGNUP_REQUESTED":return Object(m.a)({},e,{isLoading:!0,errMess:null,user:null,success:!1});case"SIGNUP_SUCCESS":return Object(m.a)({},e,{isLoading:!1,errMess:null,user:t.payload,success:!0});case"SIGNUP_FAILED":return Object(m.a)({},e,{isLoading:!1,errMess:t.payload,user:null,success:!1});default:return e}},E=(a(80),a(26)),f=a(27),b=a(29),S=a(30),y=a(16),v=a(134),N=a(135),O=a(136),L=a(137),A=a(138),k=a(139),U=a(140),M=a(5);var j=function(e){var t=e.login,a=e.isAuthenticated,r=Object(n.useState)(""),c=Object(y.a)(r,2),l=c[0],o=c[1],u=Object(n.useState)(""),i=Object(y.a)(u,2),m=i[0],d=i[1];return Object(n.useEffect)((function(){}),[a]),!0===a?s.a.createElement(M.a,{to:"/chat",username:l}):s.a.createElement("div",{className:"container"},s.a.createElement(v.a,null,s.a.createElement(N.a,{sm:"12",md:{size:4,offset:4}},s.a.createElement(O.a,{style:{marginTop:200,backgroundColor:" #ccffff"}},s.a.createElement(L.a,null,s.a.createElement(A.a,null,s.a.createElement("h3",null,"Chat.Io")),s.a.createElement(k.a,{onSubmit:function(e){e.preventDefault(),l&&m&&t({username:l,password:m})}},s.a.createElement("div",{className:"form-group"},s.a.createElement(U.a,{type:"text",placeholder:"username",onChange:function(e){o(e.target.value)}})),s.a.createElement("div",{className:"form-group"},s.a.createElement(U.a,{type:"password",placeholder:"password",onChange:function(e){d(e.target.value)}})),s.a.createElement("div",{className:"form-group"},s.a.createElement(U.a,{type:"submit",className:"btn btn-primary btn-block",value:"Log In",name:"submit"}))))))))};var C=function(e){var t=e.signup,a=e.isAuthenticated,r=e.success,c=Object(n.useState)(""),l=Object(y.a)(c,2),o=l[0],u=l[1],i=Object(n.useState)(""),m=Object(y.a)(i,2),d=m[0],p=m[1];return Object(n.useEffect)((function(){}),[r]),!0===a?s.a.createElement(M.a,{to:"/chat"}):!0===r?s.a.createElement(M.a,{to:"/login"}):s.a.createElement("div",{className:"container"},s.a.createElement(v.a,null,s.a.createElement(N.a,{sm:"12",md:{size:4,offset:4}},s.a.createElement(O.a,{style:{marginTop:200,backgroundColor:" #ccffff"}},s.a.createElement(L.a,null,s.a.createElement(A.a,null,s.a.createElement("h3",null,"Chat.Io")),s.a.createElement(k.a,{onSubmit:function(e){e.preventDefault(),o&&d&&t({username:o,password:d})}},s.a.createElement("div",{className:"form-group"},s.a.createElement(U.a,{type:"text",placeholder:"username",onChange:function(e){return u(e.target.value)}})),s.a.createElement("div",{className:"form-group"},s.a.createElement(U.a,{type:"password",placeholder:"password",onChange:function(e){return p(e.target.value)}})),s.a.createElement("div",{className:"form-group"},s.a.createElement(U.a,{type:"submit",className:"btn btn-primary btn-block",value:"Sign Up",name:"submit"}))))))))},_=a(141),I=a(142),x=a(69),D=a.n(x),w=function(e){var t=e.userid,a=e.messages;if(!0===a.isLoading)return s.a.createElement("div",null);if(a.errMess)return s.a.createElement("div",null,a.err);var n=(a=a.messages.filter((function(e){return e.thread.participant1===a.selecteduser||e.thread.participant2===a.selecteduser}))).map((function(e){return e.sender===t?s.a.createElement("button",{key:e._id,className:"messagebutton btn btn-block "},s.a.createElement("span",{className:"sender"},e.message)):s.a.createElement("button",{key:e._id,className:"messagebutton btn btn-block"},s.a.createElement("span",{className:"receiver"},e.message))}));return t?s.a.createElement("div",{className:"innermessagebox"},n):s.a.createElement(s.a.Fragment,null)},G=function(e){var t=e.connectedUsers,a=e.setSelected;if(!0===t.isLoading)return s.a.createElement("div",null);if(t.errMess)return s.a.createElement("div",null,t.err);var n=t.users.map((function(e){return s.a.createElement(_.a,{className:"userbutton btn btn-light mb-1 ",key:e._id,id:e._id,onClick:function(){a(e._id)}},e.username)}));return s.a.createElement(I.a,{className:"list-group",id:"allusers"},n)},T=function(e){Object(S.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(E.a)(this,a),(n=t.call(this,e)).setNewMessage=function(e){n.setState({newMessage:e})},n.sendMessage=function(e){e.preventDefault(),n.state.socket.emit("send message",{sender:n.state.user,receiver:n.props.connectedUsers.users.filter((function(e){return e._id===n.props.messages.selecteduser}))[0],newMessage:n.state.newMessage})},n.filterUsers=function(){var e,t,a,n;for(e=document.getElementById("searchkey").value.toUpperCase(),t=document.getElementById("allusers").getElementsByTagName("button"),n=0;n<t.length;n++)((a=t[n]).textContent||a.innerText).toUpperCase().indexOf(e)>-1?t[n].style.display="":t[n].style.display="none"},n.state={user:n.props.auth.user,token:n.props.auth.token,newMessage:"",socket:D()("localhost:8000")},n}return Object(f.a)(a,[{key:"componentDidMount",value:function(){var e=this;!0===this.props.auth.isAuthenticated&&!1===this.props.auth.isLoading&&(this.state.socket.emit("connection",this.state.user.username),this.state.socket.emit("get connected",this.state.user),this.state.socket.on("new message",(function(t){e.props.addNewMessage(t)})),window.scrollTo(0,document.querySelector(".messagebox").scrollHeight))}},{key:"render",value:function(){var e=this;return!0===this.props.auth.isLoading?s.a.createElement("div",null):!1===this.props.auth.isAuthenticated?s.a.createElement(M.a,{to:"/"}):s.a.createElement("div",{className:"container mt-1"},s.a.createElement(v.a,{className:"bgcolor"},s.a.createElement(N.a,{xs:{size:4},md:{size:4},style:{paddingLeft:"0px",paddingRight:"0px"}},s.a.createElement(O.a,{className:"bgcolor "},s.a.createElement(L.a,null,s.a.createElement("div",{className:"currentuser"},s.a.createElement(_.a,{className:"btn btn-light btn-block mb-2",style:{backgroundColor:"#00cccc"}},s.a.createElement("h5",null,s.a.createElement("span",{className:"fa fa-user-circle-o fa-2x icon"}),this.state.user.username))),s.a.createElement(k.a,null,s.a.createElement(U.a,{type:"text",placeholder:"search",name:"searchbox",className:"searchbox",id:"searchkey",onKeyUp:this.filterUsers})),s.a.createElement("div",null,s.a.createElement(G,{connectedUsers:this.props.connectedUsers,setSelected:this.props.setSelected}))))),s.a.createElement(N.a,{xs:{size:8},md:{size:8},style:{paddingLeft:"0px",paddingRight:"0px"}},s.a.createElement(O.a,{className:"bgcolor"},s.a.createElement(L.a,null,s.a.createElement(v.a,null,s.a.createElement(N.a,{md:{size:12}},s.a.createElement("div",null,this.props.messages.selecteduser?s.a.createElement(_.a,{className:"selecteduser btn btn-light btn-block mb-2",style:{backgroundColor:"#00cccc"}},s.a.createElement("h5",null,this.props.connectedUsers.users.filter((function(t){return t._id===e.props.messages.selecteduser}))[0].username)):s.a.createElement(s.a.Fragment,null)),s.a.createElement("div",{key:"messages",className:"messagebox",style:{display:"block",textAlign:"left"}},s.a.createElement(w,{userid:this.state.user._id,messages:this.props.messages})))),this.props.messages.selecteduser?s.a.createElement(k.a,{onSubmit:this.sendMessage,className:"mt-2"},s.a.createElement(v.a,null,s.a.createElement(N.a,{md:{size:10}},s.a.createElement("textarea",{type:"text",className:"form-control",onChange:function(t){e.setNewMessage(t.target.value)}})),s.a.createElement(N.a,{md:{size:2}},s.a.createElement(U.a,{type:"submit",className:"btn btn-primary",value:"send"})))):s.a.createElement(s.a.Fragment,null))))))}}]),a}(n.Component),z=function(e){var t=e.auth,a=e.logout;return s.a.createElement("div",{className:"container mt-3"},s.a.createElement("div",{className:"row",style:{backgroundColor:"#00b3b3",padding:"15px"}},s.a.createElement(N.a,{xs:{size:4},md:{size:2},style:{paddingRight:"0px"}},s.a.createElement("img",{src:"logo1.png",alt:"logo",height:50,width:100})),s.a.createElement(N.a,{xs:{size:5},md:{size:8},style:{paddingLeft:"0px"}},s.a.createElement("h3",{style:{textAlign:"left"}},"ChatIo")),s.a.createElement(N.a,{xs:{size:3},md:{size:2}},s.a.createElement("div",{style:{paddingTop:"6px"}},t.isAuthenticated?s.a.createElement(_.a,{className:"ml-auto",onClick:a},s.a.createElement("span",{className:"fa fa-sign-out"}),"Logout"):null))))},R=a(18),F=a.n(R),P=function(e){return{type:"MESSAGES_FAILED",payload:e.message}},Q=function(e){return{type:"USERS_FAILED",payload:e.message}},B=function(e){return{type:"SIGNUP_FAILED",payload:e}},J=function(e){Object(S.a)(a,e);var t=Object(b.a)(a);function a(){return Object(E.a)(this,a),t.apply(this,arguments)}return Object(f.a)(a,[{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated&&(this.props.fetchConnectedUsers(this.props.auth.token),this.props.fetchMessages(this.props.auth.token))}},{key:"componentDidUpdate",value:function(e){!1===e.auth.isAuthenticated&&!0===this.props.auth.isAuthenticated&&(this.props.fetchConnectedUsers(this.props.auth.token),this.props.fetchMessages(this.props.auth.token))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(z,{auth:this.props.auth,logout:this.props.logout}),s.a.createElement(M.d,null,s.a.createElement(M.b,{path:"/",exact:!0,component:function(){return s.a.createElement(j,{login:e.props.login,isAuthenticated:e.props.auth.isAuthenticated})}}),s.a.createElement(M.b,{path:"/login",exact:!0,component:function(){return s.a.createElement(j,{login:e.props.login,isAuthenticated:e.props.auth.isAuthenticated})}}),s.a.createElement(M.b,{path:"/signup",exact:!0,component:function(){return s.a.createElement(C,{signup:e.props.signup,isAuthenticated:e.props.auth.isAuthenticated,success:e.props.signupSuccess})}}),s.a.createElement(M.b,{path:"/chat",exact:!0,component:function(){return s.a.createElement(T,{connectedUsers:e.props.users,messages:e.props.messages,logout:e.props.logout,setSelected:e.props.setSelected,addNewMessage:e.props.addNewMessage,auth:e.props.auth})}}),s.a.createElement(M.b,{path:"*",component:j})))}}]),a}(n.Component),q=Object(M.g)(Object(o.b)((function(e){return{messages:e.messages,users:e.users,auth:e.auth,signupSuccess:e.signup.success}}),(function(e){return{fetchMessages:function(t){return e(function(e){return function(t){var a="Bearer "+e;t({type:"LOADING_MESSAGES"}),F()({method:"get",url:"http://localhost:8000/chatting/getmessages",headers:{"Content-Type":"application/json",Authorization:a}}).then((function(e){t({type:"ADD_MESSAGES",payload:e.data.messages})})).catch((function(e){return t(P(e))}))}}(t))},fetchConnectedUsers:function(t){return e(function(e){return function(t){var a="Bearer "+e;t({type:"LOADING_USERS"}),F()({method:"get",url:"http://localhost:8000/chatting/getconnectedusers",headers:{"Content-Type":"application/json",Authorization:a}}).then((function(e){t({type:"ADD_USERS",payload:e.data.users})})).catch((function(e){return t(Q(e))}))}}(t))},login:function(t){return e(function(e){return function(t){t(function(e){return{type:"LOGIN_REQUEST",creds:e}}(e)),F()({method:"post",url:"http://localhost:8000/user/login",headers:{"Content-Type":"application/json"},data:{username:e.username,password:e.password}}).then((function(e){var a,n;localStorage.setItem("userdetails",JSON.stringify(e.data.user)),localStorage.setItem("token",e.data.token),t((a=e.data.token,n=e.data.user,{type:"LOGIN_SUCCESS",token:a,user:n}))})).catch((function(e){t({type:"LOGIN_FAILURE",error:e.message})}))}}(t))},signup:function(t){return e(function(e){return function(t){t(function(e){return{type:"SIGNUP_REQUESTED",payload:e}}(e)),F()({method:"post",url:"http://localhost:8000/user/signup",headers:{"Content-Type":"application/json"},data:{username:e.username,password:e.password}}).then((function(e){!0===e.data.success?t({type:"SIGNUP_SUCCESS"}):t(B("signup failed"))})).catch((function(e){t(B(e))}))}}(t))},logout:function(){return e((function(e){e({type:"LOGOUT_REQUEST"}),localStorage.removeItem("token"),localStorage.removeItem("userdetails"),e(P({message:"user logged out"})),e(Q({message:"user logged out"})),e({type:"LOGOUT_SUCCESS"})}))},setSelected:function(t){return e(function(e){return function(t){t(function(e){return{type:"SELECTED",payload:e}}(e))}}(t))},addNewMessage:function(t){return e(function(e){return function(t){t(function(e){return{type:"ADD_MESSAGE",payload:e}}(e.message))}}(t))}}}))(J)),H=Object(u.d)(Object(u.c)({messages:d,users:p,auth:g,signup:h}),Object(u.a)(i.a));var K=function(){return s.a.createElement(o.a,{store:H},s.a.createElement(l.a,null,s.a.createElement("div",{className:"App"},s.a.createElement(q,null))))};a(131),a(132);c.a.render(s.a.createElement(K,null),document.querySelector("#root"))},70:function(e,t,a){e.exports=a(133)},75:function(e,t,a){},80:function(e,t,a){}},[[70,1,2]]]);
//# sourceMappingURL=main.f27a8568.chunk.js.map